<!DOCTYPE html>
<!-- saved from url=(0077)file:///C:/Users/senih/AppData/Local/Temp/RtmpSK5GUG/preview-62b08e34519.html -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">



<meta name="generator" content="pandoc">
<meta name="viewport" content="width=device-width, initial-scale=1">

<style type="text/css">
@font-face {
font-family: octicons-link;
src: url(data:font/woff;charset=utf-8;base64,d09GRgABAAAAAAZwABAAAAAACFQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEU0lHAAAGaAAAAAgAAAAIAAAAAUdTVUIAAAZcAAAACgAAAAoAAQAAT1MvMgAAAyQAAABJAAAAYFYEU3RjbWFwAAADcAAAAEUAAACAAJThvmN2dCAAAATkAAAABAAAAAQAAAAAZnBnbQAAA7gAAACyAAABCUM+8IhnYXNwAAAGTAAAABAAAAAQABoAI2dseWYAAAFsAAABPAAAAZwcEq9taGVhZAAAAsgAAAA0AAAANgh4a91oaGVhAAADCAAAABoAAAAkCA8DRGhtdHgAAAL8AAAADAAAAAwGAACfbG9jYQAAAsAAAAAIAAAACABiATBtYXhwAAACqAAAABgAAAAgAA8ASm5hbWUAAAToAAABQgAAAlXu73sOcG9zdAAABiwAAAAeAAAAME3QpOBwcmVwAAAEbAAAAHYAAAB/aFGpk3jaTY6xa8JAGMW/O62BDi0tJLYQincXEypYIiGJjSgHniQ6umTsUEyLm5BV6NDBP8Tpts6F0v+k/0an2i+itHDw3v2+9+DBKTzsJNnWJNTgHEy4BgG3EMI9DCEDOGEXzDADU5hBKMIgNPZqoD3SilVaXZCER3/I7AtxEJLtzzuZfI+VVkprxTlXShWKb3TBecG11rwoNlmmn1P2WYcJczl32etSpKnziC7lQyWe1smVPy/Lt7Kc+0vWY/gAgIIEqAN9we0pwKXreiMasxvabDQMM4riO+qxM2ogwDGOZTXxwxDiycQIcoYFBLj5K3EIaSctAq2kTYiw+ymhce7vwM9jSqO8JyVd5RH9gyTt2+J/yUmYlIR0s04n6+7Vm1ozezUeLEaUjhaDSuXHwVRgvLJn1tQ7xiuVv/ocTRF42mNgZGBgYGbwZOBiAAFGJBIMAAizAFoAAABiAGIAznjaY2BkYGAA4in8zwXi+W2+MjCzMIDApSwvXzC97Z4Ig8N/BxYGZgcgl52BCSQKAA3jCV8CAABfAAAAAAQAAEB42mNgZGBg4f3vACQZQABIMjKgAmYAKEgBXgAAeNpjYGY6wTiBgZWBg2kmUxoDA4MPhGZMYzBi1AHygVLYQUCaawqDA4PChxhmh/8ODDEsvAwHgMKMIDnGL0x7gJQCAwMAJd4MFwAAAHjaY2BgYGaA4DAGRgYQkAHyGMF8NgYrIM3JIAGVYYDT+AEjAwuDFpBmA9KMDEwMCh9i/v8H8sH0/4dQc1iAmAkALaUKLgAAAHjaTY9LDsIgEIbtgqHUPpDi3gPoBVyRTmTddOmqTXThEXqrob2gQ1FjwpDvfwCBdmdXC5AVKFu3e5MfNFJ29KTQT48Ob9/lqYwOGZxeUelN2U2R6+cArgtCJpauW7UQBqnFkUsjAY/kOU1cP+DAgvxwn1chZDwUbd6CFimGXwzwF6tPbFIcjEl+vvmM/byA48e6tWrKArm4ZJlCbdsrxksL1AwWn/yBSJKpYbq8AXaaTb8AAHja28jAwOC00ZrBeQNDQOWO//sdBBgYGRiYWYAEELEwMTE4uzo5Zzo5b2BxdnFOcALxNjA6b2ByTswC8jYwg0VlNuoCTWAMqNzMzsoK1rEhNqByEyerg5PMJlYuVueETKcd/89uBpnpvIEVomeHLoMsAAe1Id4AAAAAAAB42oWQT07CQBTGv0JBhagk7HQzKxca2sJCE1hDt4QF+9JOS0nbaaYDCQfwCJ7Au3AHj+LO13FMmm6cl7785vven0kBjHCBhfpYuNa5Ph1c0e2Xu3jEvWG7UdPDLZ4N92nOm+EBXuAbHmIMSRMs+4aUEd4Nd3CHD8NdvOLTsA2GL8M9PODbcL+hD7C1xoaHeLJSEao0FEW14ckxC+TU8TxvsY6X0eLPmRhry2WVioLpkrbp84LLQPGI7c6sOiUzpWIWS5GzlSgUzzLBSikOPFTOXqly7rqx0Z1Q5BAIoZBSFihQYQOOBEdkCOgXTOHA07HAGjGWiIjaPZNW13/+lm6S9FT7rLHFJ6fQbkATOG1j2OFMucKJJsxIVfQORl+9Jyda6Sl1dUYhSCm1dyClfoeDve4qMYdLEbfqHf3O/AdDumsjAAB42mNgYoAAZQYjBmyAGYQZmdhL8zLdDEydARfoAqIAAAABAAMABwAKABMAB///AA8AAQAAAAAAAAAAAAAAAAABAAAAAA==) format('woff');
}
body {
-webkit-text-size-adjust: 100%;
text-size-adjust: 100%;
color: #333;
font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
font-size: 16px;
line-height: 1.6;
word-wrap: break-word;
}
a {
background-color: transparent;
}
a:active,
a:hover {
outline: 0;
}
strong {
font-weight: bold;
}
h1 {
font-size: 2em;
margin: 0.67em 0;
}
img {
border: 0;
}
hr {
box-sizing: content-box;
height: 0;
}
pre {
overflow: auto;
}
code,
kbd,
pre {
font-family: monospace, monospace;
font-size: 1em;
}
input {
color: inherit;
font: inherit;
margin: 0;
}
html input[disabled] {
cursor: default;
}
input {
line-height: normal;
}
input[type="checkbox"] {
box-sizing: border-box;
padding: 0;
}
table {
border-collapse: collapse;
border-spacing: 0;
}
td,
th {
padding: 0;
}
* {
box-sizing: border-box;
}
input {
font: 13px / 1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
}
a {
color: #4078c0;
text-decoration: none;
}
a:hover,
a:active {
text-decoration: underline;
}
hr {
height: 0;
margin: 15px 0;
overflow: hidden;
background: transparent;
border: 0;
border-bottom: 1px solid #ddd;
}
hr:before {
display: table;
content: "";
}
hr:after {
display: table;
clear: both;
content: "";
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 15px;
margin-bottom: 15px;
line-height: 1.1;
}
h1 {
font-size: 30px;
}
h2 {
font-size: 21px;
}
h3 {
font-size: 16px;
}
h4 {
font-size: 14px;
}
h5 {
font-size: 12px;
}
h6 {
font-size: 11px;
}
blockquote {
margin: 0;
}
ul,
ol {
padding: 0;
margin-top: 0;
margin-bottom: 0;
}
ol ol,
ul ol {
list-style-type: lower-roman;
}
ul ul ol,
ul ol ol,
ol ul ol,
ol ol ol {
list-style-type: lower-alpha;
}
dd {
margin-left: 0;
}
code {
font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
font-size: 12px;
}
pre {
margin-top: 0;
margin-bottom: 0;
font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
}
.select::-ms-expand {
opacity: 0;
}
.octicon {
font: normal normal normal 16px/1 octicons-link;
display: inline-block;
text-decoration: none;
text-rendering: auto;
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
-webkit-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
}
.octicon-link:before {
content: '\f05c';
}
.markdown-body:before {
display: table;
content: "";
}
.markdown-body:after {
display: table;
clear: both;
content: "";
}
.markdown-body>*:first-child {
margin-top: 0 !important;
}
.markdown-body>*:last-child {
margin-bottom: 0 !important;
}
a:not([href]) {
color: inherit;
text-decoration: none;
}
.anchor {
display: inline-block;
padding-right: 2px;
margin-left: -18px;
}
.anchor:focus {
outline: none;
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 1em;
margin-bottom: 16px;
font-weight: bold;
line-height: 1.4;
}
h1 .octicon-link,
h2 .octicon-link,
h3 .octicon-link,
h4 .octicon-link,
h5 .octicon-link,
h6 .octicon-link {
color: #000;
vertical-align: middle;
visibility: hidden;
}
h1:hover .anchor,
h2:hover .anchor,
h3:hover .anchor,
h4:hover .anchor,
h5:hover .anchor,
h6:hover .anchor {
text-decoration: none;
}
h1:hover .anchor .octicon-link,
h2:hover .anchor .octicon-link,
h3:hover .anchor .octicon-link,
h4:hover .anchor .octicon-link,
h5:hover .anchor .octicon-link,
h6:hover .anchor .octicon-link {
visibility: visible;
}
h1 {
padding-bottom: 0.3em;
font-size: 2.25em;
line-height: 1.2;
border-bottom: 1px solid #eee;
}
h1 .anchor {
line-height: 1;
}
h2 {
padding-bottom: 0.3em;
font-size: 1.75em;
line-height: 1.225;
border-bottom: 1px solid #eee;
}
h2 .anchor {
line-height: 1;
}
h3 {
font-size: 1.5em;
line-height: 1.43;
}
h3 .anchor {
line-height: 1.2;
}
h4 {
font-size: 1.25em;
}
h4 .anchor {
line-height: 1.2;
}
h5 {
font-size: 1em;
}
h5 .anchor {
line-height: 1.1;
}
h6 {
font-size: 1em;
color: #777;
}
h6 .anchor {
line-height: 1.1;
}
p,
blockquote,
ul,
ol,
dl,
table,
pre {
margin-top: 0;
margin-bottom: 16px;
}
hr {
height: 4px;
padding: 0;
margin: 16px 0;
background-color: #e7e7e7;
border: 0 none;
}
ul,
ol {
padding-left: 2em;
}
ul ul,
ul ol,
ol ol,
ol ul {
margin-top: 0;
margin-bottom: 0;
}
li>p {
margin-top: 16px;
}
dl {
padding: 0;
}
dl dt {
padding: 0;
margin-top: 16px;
font-size: 1em;
font-style: italic;
font-weight: bold;
}
dl dd {
padding: 0 16px;
margin-bottom: 16px;
}
blockquote {
padding: 0 15px;
color: #777;
border-left: 4px solid #ddd;
}
blockquote>:first-child {
margin-top: 0;
}
blockquote>:last-child {
margin-bottom: 0;
}
table {
display: block;
width: 100%;
overflow: auto;
word-break: normal;
word-break: keep-all;
}
table th {
font-weight: bold;
}
table th,
table td {
padding: 6px 13px;
border: 1px solid #ddd;
}
table tr {
background-color: #fff;
border-top: 1px solid #ccc;
}
table tr:nth-child(2n) {
background-color: #f8f8f8;
}
img {
max-width: 100%;
box-sizing: content-box;
background-color: #fff;
}
code {
padding: 0;
padding-top: 0.2em;
padding-bottom: 0.2em;
margin: 0;
font-size: 85%;
background-color: rgba(0,0,0,0.04);
border-radius: 3px;
}
code:before,
code:after {
letter-spacing: -0.2em;
content: "\00a0";
}
pre>code {
padding: 0;
margin: 0;
font-size: 100%;
word-break: normal;
white-space: pre;
background: transparent;
border: 0;
}
.highlight {
margin-bottom: 16px;
}
.highlight pre,
pre {
padding: 16px;
overflow: auto;
font-size: 85%;
line-height: 1.45;
background-color: #f7f7f7;
border-radius: 3px;
}
.highlight pre {
margin-bottom: 0;
word-break: normal;
}
pre {
word-wrap: normal;
}
pre code {
display: inline;
max-width: initial;
padding: 0;
margin: 0;
overflow: initial;
line-height: inherit;
word-wrap: normal;
background-color: transparent;
border: 0;
}
pre code:before,
pre code:after {
content: normal;
}
kbd {
display: inline-block;
padding: 3px 5px;
font-size: 11px;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.pl-c {
color: #969896;
}
.pl-c1,
.pl-s .pl-v {
color: #0086b3;
}
.pl-e,
.pl-en {
color: #795da3;
}
.pl-s .pl-s1,
.pl-smi {
color: #333;
}
.pl-ent {
color: #63a35c;
}
.pl-k {
color: #a71d5d;
}
.pl-pds,
.pl-s,
.pl-s .pl-pse .pl-s1,
.pl-sr,
.pl-sr .pl-cce,
.pl-sr .pl-sra,
.pl-sr .pl-sre {
color: #183691;
}
.pl-v {
color: #ed6a43;
}
.pl-id {
color: #b52a1d;
}
.pl-ii {
background-color: #b52a1d;
color: #f8f8f8;
}
.pl-sr .pl-cce {
color: #63a35c;
font-weight: bold;
}
.pl-ml {
color: #693a17;
}
.pl-mh,
.pl-mh .pl-en,
.pl-ms {
color: #1d3e81;
font-weight: bold;
}
.pl-mq {
color: #008080;
}
.pl-mi {
color: #333;
font-style: italic;
}
.pl-mb {
color: #333;
font-weight: bold;
}
.pl-md {
background-color: #ffecec;
color: #bd2c00;
}
.pl-mi1 {
background-color: #eaffea;
color: #55a532;
}
.pl-mdr {
color: #795da3;
font-weight: bold;
}
.pl-mo {
color: #1d3e81;
}
kbd {
display: inline-block;
padding: 3px 5px;
font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.task-list-item {
list-style-type: none;
}
.task-list-item+.task-list-item {
margin-top: 3px;
}
.task-list-item input {
margin: 0 0.35em 0.25em -1.6em;
vertical-align: middle;
}
:checked+.radio-label {
z-index: 1;
position: relative;
border-color: #4078c0;
}
.sourceLine {
display: inline-block;
}
code .kw { color: #000000; }
code .dt { color: #ed6a43; }
code .dv { color: #009999; }
code .bn { color: #009999; }
code .fl { color: #009999; }
code .ch { color: #009999; }
code .st { color: #183691; }
code .co { color: #969896; }
code .ot { color: #0086b3; }
code .al { color: #a61717; }
code .fu { color: #63a35c; }
code .er { color: #a61717; background-color: #e3d2d2; }
code .wa { color: #000000; }
code .cn { color: #008080; }
code .sc { color: #008080; }
code .vs { color: #183691; }
code .ss { color: #183691; }
code .im { color: #000000; }
code .va {color: #008080; }
code .cf { color: #000000; }
code .op { color: #000000; }
code .bu { color: #000000; }
code .ex { color: #000000; }
code .pp { color: #999999; }
code .at { color: #008080; }
code .do { color: #969896; }
code .an { color: #008080; }
code .cv { color: #008080; }
code .in { color: #008080; }
</style>
<style>
body {
  box-sizing: border-box;
  min-width: 200px;
  max-width: 980px;
  margin: 0 auto;
  padding: 45px;
  padding-top: 0px;
}
</style>

</head>

<body>

<h1 id="customer-reviews-with-natural-language-processing">Customer reviews with Natural Language Processing</h1>
<p>We have the reviews of a restaurant. We will use machine learning NLP algorithm to predict if the review is positive or negative.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># Natural Language Processing</span></a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co"># Importing the dataset</span></a>
<a class="sourceLine" id="cb1-4" title="4">dataset_original =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">'Restaurant_Reviews.tsv'</span>, <span class="dt">quote =</span> <span class="st">''</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>Dataset is presented in the tsv file format. It is a tab-separated values format which is very similar to csv (comma-separated values) format. This format is considered to be better then csv for NLP because commas are very likely to be a part of a sentence and csv file will recognize them as separators. And tabs are not likely to be the part of the sentence. So mind this and always use tsv format.</p>
<p>Here we have only two columns: Review and Liked. Liked is 1 for positive comments and 0 for negative</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># Cleaning the texts</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="co">#install.packages('tm')</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co">#install.packages('SnowballC')</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="kw">library</span>(tm)</a></code></pre></div>
<pre><code>## Warning: package 'tm' was built under R version 3.6.3

## Loading required package: NLP
</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">library</span>(SnowballC)</a>
<a class="sourceLine" id="cb4-2" title="2">corpus =<span class="st"> </span><span class="kw">VCorpus</span>(<span class="kw">VectorSource</span>(dataset_original<span class="op">$</span>Review)) <span class="co"># first step of cleaning the dataset for getting it ready for NLP</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="kw">as.character</span>(corpus[[<span class="dv">1</span>]])</a></code></pre></div>
<pre><code>## [1] "Wow... Loved this place."
</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">corpus =<span class="st"> </span><span class="kw">tm_map</span>(corpus, <span class="kw">content_transformer</span>(tolower))  <span class="co"># write all the reviews with lower case. by doing that the same word written with both upper case and lower case will be understood as one word.</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw">as.character</span>(corpus[[<span class="dv">1</span>]]) <span class="co">#check if it lowercase</span></a></code></pre></div>
<pre><code>## [1] "wow... loved this place."
</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">corpus =<span class="st"> </span><span class="kw">tm_map</span>(corpus, removeNumbers) </a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw">as.character</span>(corpus[[<span class="dv">1</span>]]) <span class="co">#check if the numbers removed</span></a></code></pre></div>
<pre><code>## [1] "wow... loved this place."
</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">corpus =<span class="st"> </span><span class="kw">tm_map</span>(corpus, removePunctuation) <span class="co"># removes punctuation</span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="kw">as.character</span>(corpus[[<span class="dv">1</span>]]) <span class="co">#check if the punctuations removed</span></a></code></pre></div>
<pre><code>## [1] "wow loved this place"
</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">library</span>(SnowballC) <span class="co">#this library is necessary for removing unrelevant words</span></a>
<a class="sourceLine" id="cb12-2" title="2">corpus =<span class="st"> </span><span class="kw">tm_map</span>(corpus, removeWords, <span class="kw">stopwords</span>()) <span class="co"># removes the unrelevant words for NLP</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="kw">as.character</span>(corpus[[<span class="dv">1</span>]]) <span class="co"># see unrelevant words are removed</span></a></code></pre></div>
<pre><code>## [1] "wow loved  place"
</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">corpus =<span class="st"> </span><span class="kw">tm_map</span>(corpus, stemDocument) <span class="co"># getting the root of each word</span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="kw">as.character</span>(corpus[[<span class="dv">1</span>]])</a></code></pre></div>
<pre><code>## [1] "wow love place"
</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">corpus =<span class="st"> </span><span class="kw">tm_map</span>(corpus, stripWhitespace) <span class="co"># removing extra spaces caused by previous steps</span></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="kw">as.character</span>(corpus[[<span class="dv">841</span>]])</a></code></pre></div>
<pre><code>## [1] "buck head realli expect better food"
</code></pre>
<p>The data is clean now. This dataset has 1000 rows. And assume that this dataset has 1500 different words.That mean is is going to be 1500 columns and 1000 rows. The dataset become huge now.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="co"># Creating the Bag of Words model</span></a>
<a class="sourceLine" id="cb18-2" title="2">dtm =<span class="st"> </span><span class="kw">DocumentTermMatrix</span>(corpus) <span class="co"># this function creates the huge function I talk about above.</span></a>
<a class="sourceLine" id="cb18-3" title="3">dtm <span class="co"># as you see here the sparsity is %100. THe reason is the dataset has too many 0.</span></a></code></pre></div>
<pre><code>## &lt;&lt;DocumentTermMatrix (documents: 1000, terms: 1577)&gt;&gt;
## Non-/sparse entries: 5435/1571565
## Sparsity           : 100%
## Maximal term length: 32
## Weighting          : term frequency (tf)
</code></pre>
<p>It has 1577 terms.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">dtm =<span class="st"> </span><span class="kw">removeSparseTerms</span>(dtm, <span class="fl">0.999</span>) <span class="co"># filter nonfrequent words of the matrix. We want to keep the %99 of the most frequent words.</span></a>
<a class="sourceLine" id="cb20-2" title="2">dtm</a></code></pre></div>
<pre><code>## &lt;&lt;DocumentTermMatrix (documents: 1000, terms: 691)&gt;&gt;
## Non-/sparse entries: 4549/686451
## Sparsity           : 99%
## Maximal term length: 12
## Weighting          : term frequency (tf)
</code></pre>
<p>After filtering non ferequent words number of terms reduced to 691. Now the column number is 691. This function removed nonfrequent words. And made dataset more predictible and significant. We choose 0.999 because we have 1000 observations which is not so big. So we choose big number like 0.999.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="co"># Since our dataset is matrix, we need to convert it to dataframe for classification models</span></a>
<a class="sourceLine" id="cb22-2" title="2">dataset =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">as.matrix</span>(dtm))</a>
<a class="sourceLine" id="cb22-3" title="3"><span class="kw">head</span>(dataset)</a></code></pre></div>
<pre><code>##   absolut acknowledg actual ago almost also although alway amaz ambianc
## 1       0          0      0   0      0    0        0     0    0       0
## 2       0          0      0   0      0    0        0     0    0       0
## 3       0          0      0   0      0    0        0     0    0       0
## 4       0          0      0   0      0    0        0     0    0       0
## 5       0          0      0   0      0    0        0     0    0       0
## 6       0          0      0   0      0    0        0     0    0       0
##   ambienc amount anoth anyon anyth anytim anyway apolog appet area arent
## 1       0      0     0     0     0      0      0      0     0    0     0
## 2       0      0     0     0     0      0      0      0     0    0     0
## 3       0      0     0     0     0      0      0      0     0    0     0
## 4       0      0     0     0     0      0      0      0     0    0     0
## 5       0      0     0     0     0      0      0      0     0    0     0
## 6       0      0     0     0     0      0      0      0     0    0     0
##   around arriv ask assur ate atmospher attack attent attitud authent
## 1      0     0   0     0   0         0      0      0       0       0
## 2      0     0   0     0   0         0      0      0       0       0
## 3      0     0   0     0   0         0      0      0       0       0
## 4      0     0   0     0   0         0      0      0       0       0
## 5      0     0   0     0   0         0      0      0       0       0
## 6      0     0   0     0   0         0      0      0       0       0
##   averag avoid away awesom awkward babi bachi back bacon bad bagel bakeri
## 1      0     0    0      0       0    0     0    0     0   0     0      0
## 2      0     0    0      0       0    0     0    0     0   0     0      0
## 3      0     0    0      0       0    0     0    0     0   0     0      0
## 4      0     0    0      0       0    0     0    0     0   0     0      0
## 5      0     0    0      0       0    0     0    0     0   0     0      0
## 6      0     0    0      0       0    0     0    0     0   0     0      0
##   bar bare bartend basic bathroom batter bay bean beat beauti becom beef
## 1   0    0       0     0        0      0   0    0    0      0     0    0
## 2   0    0       0     0        0      0   0    0    0      0     0    0
## 3   0    0       0     0        0      0   0    0    0      0     0    0
## 4   0    0       0     0        0      0   0    0    0      0     0    0
## 5   0    0       0     0        0      0   0    0    0      0     0    0
## 6   0    0       0     0        0      0   0    0    0      0     0    0
##   beer behind believ belli best better beyond big bill biscuit bisqu bit
## 1    0      0      0     0    0      0      0   0    0       0     0   0
## 2    0      0      0     0    0      0      0   0    0       0     0   0
## 3    0      0      0     0    0      0      0   0    0       0     0   0
## 4    0      0      0     0    0      0      0   0    0       0     0   0
## 5    0      0      0     0    0      0      0   0    0       0     0   0
## 6    0      0      0     0    0      0      0   0    0       0     0   0
##   bite black bland blow boba boot bother bowl box boy boyfriend bread
## 1    0     0     0    0    0    0      0    0   0   0         0     0
## 2    0     0     0    0    0    0      0    0   0   0         0     0
## 3    0     0     0    0    0    0      0    0   0   0         0     0
## 4    0     0     0    0    0    0      0    0   0   0         0     0
## 5    0     0     0    0    0    0      0    0   0   0         0     0
## 6    0     0     0    0    0    0      0    0   0   0         0     0
##   break breakfast brick bring brought brunch buck buffet build burger busi
## 1     0         0     0     0       0      0    0      0     0      0    0
## 2     0         0     0     0       0      0    0      0     0      0    0
## 3     0         0     0     0       0      0    0      0     0      0    0
## 4     0         0     0     0       0      0    0      0     0      0    0
## 5     0         0     0     0       0      0    0      0     0      0    0
## 6     0         0     0     0       0      0    0      0     0      0    0
##   butter cafe call came can cant car care cashier char charcoal charg
## 1      0    0    0    0   0    0   0    0       0    0        0     0
## 2      0    0    0    0   0    0   0    0       0    0        0     0
## 3      0    0    0    0   0    0   0    0       0    0        0     0
## 4      0    0    0    0   0    0   0    0       0    0        0     0
## 5      0    0    0    0   0    0   0    0       0    0        0     0
## 6      0    0    0    0   0    0   0    0       0    0        0     0
##   cheap check chees cheeseburg chef chewi chicken chines chip choos
## 1     0     0     0          0    0     0       0      0    0     0
## 2     0     0     0          0    0     0       0      0    0     0
## 3     0     0     0          0    0     0       0      0    0     0
## 4     0     0     0          0    0     0       0      0    0     0
## 5     0     0     0          0    0     0       0      0    0     0
## 6     0     0     0          0    0     0       0      0    0     0
##   classic clean close cocktail coffe cold color combin combo come comfort
## 1       0     0     0        0     0    0     0      0     0    0       0
## 2       0     0     0        0     0    0     0      0     0    0       0
## 3       0     0     0        0     0    0     0      0     0    0       0
## 4       0     0     0        0     0    0     0      0     0    0       0
## 5       0     0     0        0     0    0     0      0     0    0       0
## 6       0     0     0        0     0    0     0      0     0    0       0
##   compani complain complaint complet consid contain conveni cook cool
## 1       0        0         0       0      0       0       0    0    0
## 2       0        0         0       0      0       0       0    0    0
## 3       0        0         0       0      0       0       0    0    0
## 4       0        0         0       0      0       0       0    0    0
## 5       0        0         0       0      0       0       0    0    0
## 6       0        0         0       0      0       0       0    0    0
##   correct couldnt coupl cours cover cow crazi cream creami crowd crust
## 1       0       0     0     0     0   0     0     0      0     0     0
## 2       0       0     0     0     0   0     0     0      0     0     1
## 3       0       0     0     0     0   0     0     0      0     0     0
## 4       0       0     0     0     0   0     0     0      0     0     0
## 5       0       0     0     0     0   0     0     0      0     0     0
## 6       0       0     0     0     0   0     0     0      0     0     0
##   curri custom cut cute damn dark date day deal decent decid decor defin
## 1     0      0   0    0    0    0    0   0    0      0     0     0     0
## 2     0      0   0    0    0    0    0   0    0      0     0     0     0
## 3     0      0   0    0    0    0    0   0    0      0     0     0     0
## 4     0      0   0    0    0    0    0   0    0      0     0     0     0
## 5     0      0   0    0    0    0    0   0    0      0     0     0     0
## 6     0      0   0    0    1    0    0   0    0      0     0     0     0
##   definit delici delight delish deserv dessert didnt die differ dine
## 1       0      0       0      0      0       0     0   0      0    0
## 2       0      0       0      0      0       0     0   0      0    0
## 3       0      0       0      0      0       0     0   0      0    0
## 4       0      0       0      0      0       0     0   0      0    0
## 5       0      0       0      0      0       0     0   0      0    0
## 6       0      0       0      0      0       0     0   0      0    0
##   dinner dirt dirti disappoint disgrac disgust dish disrespect dog done
## 1      0    0     0          0       0       0    0          0   0    0
## 2      0    0     0          0       0       0    0          0   0    0
## 3      0    0     0          0       0       0    0          0   0    0
## 4      0    0     0          0       0       0    0          0   0    0
## 5      0    0     0          0       0       0    0          0   0    0
## 6      0    0     0          0       0       0    0          0   0    0
##   dont door doubl doubt downtown dress dri driest drink drive duck eat
## 1    0    0     0     0        0     0   0      0     0     0    0   0
## 2    0    0     0     0        0     0   0      0     0     0    0   0
## 3    0    0     0     0        0     0   0      0     0     0    0   0
## 4    0    0     0     0        0     0   0      0     0     0    0   0
## 5    0    0     0     0        0     0   0      0     0     0    0   0
## 6    0    0     0     0        0     0   0      0     0     0    0   0
##   eaten edibl egg eggplant either els elsewher employe empti end enjoy
## 1     0     0   0        0      0   0        0       0     0   0     0
## 2     0     0   0        0      0   0        0       0     0   0     0
## 3     0     0   0        0      0   0        0       0     0   0     0
## 4     0     0   0        0      0   0        0       0     0   0     0
## 5     0     0   0        0      0   0        0       0     0   0     0
## 6     0     0   0        0      0   0        0       0     0   0     0
##   enough entre equal especi establish even event ever everi everyon
## 1      0     0     0      0         0    0     0    0     0       0
## 2      0     0     0      0         0    0     0    0     0       0
## 3      0     0     0      0         0    0     0    0     0       0
## 4      0     0     0      0         0    0     0    0     0       0
## 5      0     0     0      0         0    0     0    0     0       0
## 6      0     0     0      0         0    0     0    0     0       0
##   everyth excel excus expect experi experienc extra extrem eye fact fail
## 1       0     0     0      0      0         0     0      0   0    0    0
## 2       0     0     0      0      0         0     0      0   0    0    0
## 3       0     0     0      0      0         0     0      0   0    0    0
## 4       0     0     0      0      0         0     0      0   0    0    0
## 5       0     0     0      0      0         0     0      0   0    0    0
## 6       0     0     0      0      0         0     0      0   0    0    0
##   fair famili familiar fan fantast far fare fast favor favorit feel fell
## 1    0      0        0   0       0   0    0    0     0       0    0    0
## 2    0      0        0   0       0   0    0    0     0       0    0    0
## 3    0      0        0   0       0   0    0    0     0       0    0    0
## 4    0      0        0   0       0   0    0    0     0       0    0    0
## 5    0      0        0   0       0   0    0    0     0       0    0    0
## 6    0      0        0   0       0   0    0    0     0       0    0    0
##   felt filet fill final find fine finish first fish flavor flavorless
## 1    0     0    0     0    0    0      0     0    0      0          0
## 2    0     0    0     0    0    0      0     0    0      0          0
## 3    0     0    0     0    0    0      0     0    0      0          0
## 4    0     0    0     0    0    0      0     0    0      0          0
## 5    0     0    0     0    0    0      0     0    0      0          0
## 6    0     0    0     0    0    0      0     0    0      0          0
##   flower focus folk food found fresh fri friend front frozen full fun
## 1      0     0    0    0     0     0   0      0     0      0    0   0
## 2      0     0    0    0     0     0   0      0     0      0    0   0
## 3      0     0    0    0     0     0   0      0     0      0    0   0
## 4      0     0    0    0     0     0   0      0     0      0    0   0
## 5      0     0    0    0     0     0   0      0     0      0    0   0
## 6      0     0    0    0     0     0   0      0     0      0    0   0
##   garlic gave generous get give given glad gold gone good got greas great
## 1      0    0        0   0    0     0    0    0    0    0   0     0     0
## 2      0    0        0   0    0     0    0    0    0    1   0     0     0
## 3      0    0        0   0    0     0    0    0    0    0   0     0     0
## 4      0    0        0   0    0     0    0    0    0    0   0     0     0
## 5      0    0        0   0    0     0    0    0    0    0   0     0     1
## 6      0    0        0   1    0     0    0    0    0    0   0     0     0
##   greek green greet grill gross group guess guest guy gyro hair half hand
## 1     0     0     0     0     0     0     0     0   0    0    0    0    0
## 2     0     0     0     0     0     0     0     0   0    0    0    0    0
## 3     0     0     0     0     0     0     0     0   0    0    0    0    0
## 4     0     0     0     0     0     0     0     0   0    0    0    0    0
## 5     0     0     0     0     0     0     0     0   0    0    0    0    0
## 6     0     0     0     0     0     0     0     0   0    0    0    0    0
##   handl happen happi hard hate head healthi heard heart heat help high
## 1     0      0     0    0    0    0       0     0     0    0    0    0
## 2     0      0     0    0    0    0       0     0     0    0    0    0
## 3     0      0     0    0    0    0       0     0     0    0    0    0
## 4     0      0     0    0    0    0       0     0     0    0    0    0
## 5     0      0     0    0    0    0       0     0     0    0    0    0
## 6     0      0     0    0    0    0       0     0     0    0    0    0
##   highlight hit home homemad honest hope horribl hot hour hous howev huge
## 1         0   0    0       0      0    0       0   0    0    0     0    0
## 2         0   0    0       0      0    0       0   0    0    0     0    0
## 3         0   0    0       0      0    0       0   0    0    0     0    0
## 4         0   0    0       0      0    0       0   0    0    0     0    0
## 5         0   0    0       0      0    0       0   0    0    0     0    0
## 6         0   0    0       0      0    0       0   0    0    0     0    0
##   human hummus husband ice ignor ill imagin immedi impecc impress includ
## 1     0      0       0   0     0   0      0      0      0       0      0
## 2     0      0       0   0     0   0      0      0      0       0      0
## 3     0      0       0   0     0   0      0      0      0       0      0
## 4     0      0       0   0     0   0      0      0      0       0      0
## 5     0      0       0   0     0   0      0      0      0       0      0
## 6     0      0       0   0     0   0      0      0      0       0      0
##   incred indian inexpens insid insult interest isnt italian ive job joint
## 1      0      0        0     0      0        0    0       0   0   0     0
## 2      0      0        0     0      0        0    0       0   0   0     0
## 3      0      0        0     0      0        0    0       0   0   0     0
## 4      0      0        0     0      0        0    0       0   0   0     0
## 5      0      0        0     0      0        0    0       0   0   0     0
## 6      0      0        0     0      0        0    0       0   0   0     0
##   joke judg just kept kid kind know known lack ladi larg last late later
## 1    0    0    0    0   0    0    0     0    0    0    0    0    0     0
## 2    0    0    0    0   0    0    0     0    0    0    0    0    0     0
## 3    0    0    1    0   0    0    0     0    0    0    0    0    0     0
## 4    0    0    0    0   0    0    0     0    0    0    0    0    1     0
## 5    0    0    0    0   0    0    0     0    0    0    0    0    0     0
## 6    0    0    0    0   0    0    0     0    0    0    0    0    0     0
##   least leav left legit let life light like list liter littl live lobster
## 1     0    0    0     0   0    0     0    0    0     0     0    0       0
## 2     0    0    0     0   0    0     0    0    0     0     0    0       0
## 3     0    0    0     0   0    0     0    0    0     0     0    0       0
## 4     0    0    0     0   0    0     0    0    0     0     0    0       0
## 5     0    0    0     0   0    0     0    0    0     0     0    0       0
## 6     0    0    0     0   0    0     0    0    0     0     0    0       0
##   locat long longer look lost lot love lover lukewarm lunch made main make
## 1     0    0      0    0    0   0    1     0        0     0    0    0    0
## 2     0    0      0    0    0   0    0     0        0     0    0    0    0
## 3     0    0      0    0    0   0    0     0        0     0    0    0    0
## 4     0    0      0    0    0   0    1     0        0     0    0    0    0
## 5     0    0      0    0    0   0    0     0        0     0    0    0    0
## 6     0    0      0    0    0   0    0     0        0     0    0    0    0
##   mall manag mani margarita mari may mayb meal mean meat mediocr meh melt
## 1    0     0    0         0    0   0    0    0    0    0       0   0    0
## 2    0     0    0         0    0   0    0    0    0    0       0   0    0
## 3    0     0    0         0    0   0    0    0    0    0       0   0    0
## 4    0     0    0         0    0   1    0    0    0    0       0   0    0
## 5    0     0    0         0    0   0    0    0    0    0       0   0    0
## 6    0     0    0         0    0   0    0    0    0    0       0   0    0
##   menu mexican mid min mind minut miss mistak moist mom money mood mouth
## 1    0       0   0   0    0     0    0      0     0   0     0    0     0
## 2    0       0   0   0    0     0    0      0     0   0     0    0     0
## 3    0       0   0   0    0     0    0      0     0   0     0    0     0
## 4    0       0   0   0    0     0    0      0     0   0     0    0     0
## 5    1       0   0   0    0     0    0      0     0   0     0    0     0
## 6    0       0   0   0    0     0    0      0     0   0     0    0     0
##   much multipl mushroom music must nacho nasti need needless neighborhood
## 1    0       0        0     0    0     0     0    0        0            0
## 2    0       0        0     0    0     0     0    0        0            0
## 3    0       0        0     0    0     0     1    0        0            0
## 4    0       0        0     0    0     0     0    0        0            0
## 5    0       0        0     0    0     0     0    0        0            0
## 6    0       0        0     0    0     0     0    0        0            0
##   never new next nice nicest night none note noth now offer old omg one
## 1     0   0    0    0      0     0    0    0    0   0     0   0   0   0
## 2     0   0    0    0      0     0    0    0    0   0     0   0   0   0
## 3     0   0    0    0      0     0    0    0    0   0     0   0   0   0
## 4     0   0    0    0      0     0    0    0    0   0     0   0   0   0
## 5     0   0    0    0      0     0    0    0    0   0     0   0   0   0
## 6     0   0    0    0      0     0    0    0    0   1     0   0   0   0
##   opportun option order other outsid outstand oven overal overcook overpr
## 1        0      0     0     0      0        0    0      0        0      0
## 2        0      0     0     0      0        0    0      0        0      0
## 3        0      0     0     0      0        0    0      0        0      0
## 4        0      0     0     0      0        0    0      0        0      0
## 5        0      0     0     0      0        0    0      0        0      0
## 6        0      0     0     0      0        0    0      0        0      0
##   overwhelm owner pace pack paid pancak paper par part parti pass pasta
## 1         0     0    0    0    0      0     0   0    0     0    0     0
## 2         0     0    0    0    0      0     0   0    0     0    0     0
## 3         0     0    0    0    0      0     0   0    0     0    0     0
## 4         0     0    0    0    0      0     0   0    0     0    0     0
## 5         0     0    0    0    0      0     0   0    0     0    0     0
## 6         0     0    0    0    0      0     0   0    0     0    0     0
##   patio pay peanut peopl perfect person pho phoenix pictur piec pita pizza
## 1     0   0      0     0       0      0   0       0      0    0    0     0
## 2     0   0      0     0       0      0   0       0      0    0    0     0
## 3     0   0      0     0       0      0   0       0      0    0    0     0
## 4     0   0      0     0       0      0   0       0      0    0    0     0
## 5     0   0      0     0       0      0   0       0      0    0    0     0
## 6     0   0      0     0       0      0   1       0      0    0    0     0
##   place plate play pleas pleasant plus point poor pop pork portion possibl
## 1     1     0    0     0        0    0     0    0   0    0       0       0
## 2     0     0    0     0        0    0     0    0   0    0       0       0
## 3     0     0    0     0        0    0     0    0   0    0       0       0
## 4     0     0    0     0        0    0     0    0   0    0       0       0
## 5     0     0    0     0        0    0     0    0   0    0       0       0
## 6     0     0    0     0        0    0     0    0   0    0       0       0
##   potato prepar present pretti price probabl profession promis prompt
## 1      0      0       0      0     0       0          0      0      0
## 2      0      0       0      0     0       0          0      0      0
## 3      0      0       0      0     0       0          0      0      0
## 4      0      0       0      0     0       0          0      0      0
## 5      0      0       0      0     1       0          0      0      0
## 6      0      0       0      0     0       0          0      0      0
##   provid public pull pure put qualiti quick quit rare rate rather rave
## 1      0      0    0    0   0       0     0    0    0    0      0    0
## 2      0      0    0    0   0       0     0    0    0    0      0    0
## 3      0      0    0    0   0       0     0    0    0    0      0    0
## 4      0      0    0    0   0       0     0    0    0    0      0    0
## 5      0      0    0    0   0       0     0    0    0    0      0    0
## 6      0      0    0    0   0       0     0    0    0    0      0    0
##   read real realiz realli reason receiv recent recommend red refil regular
## 1    0    0      0      0      0      0      0         0   0     0       0
## 2    0    0      0      0      0      0      0         0   0     0       0
## 3    0    0      0      0      0      0      0         0   0     0       0
## 4    0    0      0      0      0      0      0         1   0     0       0
## 5    0    0      0      0      0      0      0         0   0     0       0
## 6    0    0      0      0      0      0      0         0   0     0       0
##   relax remind restaur return review rice right roast roll room rude run
## 1     0      0       0      0      0    0     0     0    0    0    0   0
## 2     0      0       0      0      0    0     0     0    0    0    0   0
## 3     0      0       0      0      0    0     0     0    0    0    0   0
## 4     0      0       0      0      0    0     0     0    0    0    0   0
## 5     0      0       0      0      0    0     0     0    0    0    0   0
## 6     0      0       0      0      0    0     0     0    0    0    0   0
##   sad said salad salmon salsa salt sandwich sashimi sat satisfi sauc say
## 1   0    0     0      0     0    0        0       0   0       0    0   0
## 2   0    0     0      0     0    0        0       0   0       0    0   0
## 3   0    0     0      0     0    0        0       0   0       0    0   0
## 4   0    0     0      0     0    0        0       0   0       0    0   0
## 5   0    0     0      0     0    0        0       0   0       0    0   0
## 6   0    0     0      0     0    0        0       0   0       0    0   0
##   scallop seafood season seat second see seem seen select serious serv
## 1       0       0      0    0      0   0    0    0      0       0    0
## 2       0       0      0    0      0   0    0    0      0       0    0
## 3       0       0      0    0      0   0    0    0      0       0    0
## 4       0       0      0    0      0   0    0    0      0       0    0
## 5       0       0      0    0      0   0    0    0      1       0    0
## 6       0       0      0    0      0   0    0    0      0       0    0
##   server servic set sever shop show shrimp sick side sign similar simpl
## 1      0      0   0     0    0    0      0    0    0    0       0     0
## 2      0      0   0     0    0    0      0    0    0    0       0     0
## 3      0      0   0     0    0    0      0    0    0    0       0     0
## 4      0      0   0     0    0    0      0    0    0    0       0     0
## 5      0      0   0     0    0    0      0    0    0    0       0     0
## 6      0      0   0     0    0    0      0    0    0    0       0     0
##   simpli sinc singl sit six slice slow small smell soggi someon someth
## 1      0    0     0   0   0     0    0     0     0     0      0      0
## 2      0    0     0   0   0     0    0     0     0     0      0      0
## 3      0    0     0   0   0     0    0     0     0     0      0      0
## 4      0    0     0   0   0     0    0     0     0     0      0      0
## 5      0    0     0   0   0     0    0     0     0     0      0      0
## 6      0    0     0   0   0     0    0     0     0     0      0      0
##   soon soooo sore soup special spend spice spici spot staff stale star
## 1    0     0    0    0       0     0     0     0    0     0     0    0
## 2    0     0    0    0       0     0     0     0    0     0     0    0
## 3    0     0    0    0       0     0     0     0    0     0     0    0
## 4    0     0    0    0       0     0     0     0    0     0     0    0
## 5    0     0    0    0       0     0     0     0    0     0     0    0
## 6    0     0    0    0       0     0     0     0    0     0     0    0
##   start station stay steak step stick still stir stomach stop strip stuf
## 1     0       0    0     0    0     0     0    0       0    0     0    0
## 2     0       0    0     0    0     0     0    0       0    0     0    0
## 3     0       0    0     0    0     0     0    0       0    0     0    0
## 4     0       0    0     0    0     0     0    0       0    1     0    0
## 5     0       0    0     0    0     0     0    0       0    0     0    0
## 6     0       0    0     0    0     0     0    0       0    0     0    0
##   stuff style subpar subway suck sugari suggest summer super sure surpris
## 1     0     0      0      0    0      0       0      0     0    0       0
## 2     0     0      0      0    0      0       0      0     0    0       0
## 3     0     0      0      0    0      0       0      0     0    0       0
## 4     0     0      0      0    0      0       0      0     0    0       0
## 5     0     0      0      0    0      0       0      0     0    0       0
## 6     0     0      0      0    0      0       0      0     0    0       0
##   sushi sweet tabl taco take talk tap tapa tartar tast tasteless tasti tea
## 1     0     0    0    0    0    0   0    0      0    0         0     0   0
## 2     0     0    0    0    0    0   0    0      0    0         0     0   0
## 3     0     0    0    0    0    0   0    0      0    0         0     1   0
## 4     0     0    0    0    0    0   0    0      0    0         0     0   0
## 5     0     0    0    0    0    0   0    0      0    0         0     0   0
## 6     0     0    0    0    0    0   0    0      0    0         0     0   0
##   tell ten tender terribl textur thai that thin thing think third though
## 1    0   0      0       0      0    0    0    0     0     0     0      0
## 2    0   0      0       0      0    0    0    0     0     0     0      0
## 3    0   0      0       0      1    0    0    0     0     0     0      0
## 4    0   0      0       0      0    0    0    0     0     0     0      0
## 5    0   0      0       0      0    0    0    0     0     0     0      0
## 6    0   0      0       0      0    0    0    0     0     0     0      0
##   thought thumb time tip toast today told took top tot total touch toward
## 1       0     0    0   0     0     0    0    0   0   0     0     0      0
## 2       0     0    0   0     0     0    0    0   0   0     0     0      0
## 3       0     0    0   0     0     0    0    0   0   0     0     0      0
## 4       0     0    0   0     0     0    0    0   0   0     0     0      0
## 5       0     0    0   0     0     0    0    0   0   0     0     0      0
## 6       0     0    0   0     0     0    0    0   0   0     0     0      0
##   town treat tri trip tuna twice two unbeliev undercook underwhelm
## 1    0     0   0    0    0     0   0        0         0          0
## 2    0     0   0    0    0     0   0        0         0          0
## 3    0     0   0    0    0     0   0        0         0          0
## 4    0     0   0    0    0     0   0        0         0          0
## 5    0     0   0    0    0     0   0        0         0          0
## 6    0     0   0    0    0     0   0        0         0          0
##   unfortun unless use valley valu vega veget vegetarian ventur vibe
## 1        0      0   0      0    0    0     0          0      0    0
## 2        0      0   0      0    0    0     0          0      0    0
## 3        0      0   0      0    0    0     0          0      0    0
## 4        0      0   0      0    0    0     0          0      0    0
## 5        0      0   0      0    0    0     0          0      0    0
## 6        0      0   0      0    0    0     0          0      0    0
##   vinegrett visit wait waiter waitress walk wall want warm wasnt wast
## 1         0     0    0      0        0    0    0    0    0     0    0
## 2         0     0    0      0        0    0    0    0    0     0    0
## 3         0     0    0      0        0    0    0    0    0     0    0
## 4         0     0    0      0        0    0    0    0    0     0    0
## 5         0     0    0      0        0    0    0    0    0     0    0
## 6         0     0    0      0        0    0    0    1    0     0    0
##   watch water way week well went weve white whole wife will wine wing
## 1     0     0   0    0    0    0    0     0     0    0    0    0    0
## 2     0     0   0    0    0    0    0     0     0    0    0    0    0
## 3     0     0   0    0    0    0    0     0     0    0    0    0    0
## 4     0     0   0    0    0    0    0     0     0    0    0    0    0
## 5     0     0   0    0    0    0    0     0     0    0    0    0    0
## 6     0     0   0    0    0    0    0     0     0    0    0    0    0
##   without wonder wont word work worker world wors worst worth wouldnt wow
## 1       0      0    0    0    0      0     0    0     0     0       0   1
## 2       0      0    0    0    0      0     0    0     0     0       0   0
## 3       0      0    0    0    0      0     0    0     0     0       0   0
## 4       0      0    0    0    0      0     0    0     0     0       0   0
## 5       0      0    0    0    0      0     0    0     0     0       0   0
## 6       0      0    0    0    0      0     0    0     0     0       0   0
##   wrap wrong year yet youd your yummi zero
## 1    0     0    0   0    0    0     0    0
## 2    0     0    0   0    0    0     0    0
## 3    0     0    0   0    0    0     0    0
## 4    0     0    0   0    0    0     0    0
## 5    0     0    0   0    0    0     0    0
## 6    0     0    0   0    0    0     0    0
</code></pre>
<p>As you see the table above there are many words are at the columns.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">dataset<span class="op">$</span>Liked =<span class="st"> </span>dataset_original<span class="op">$</span>Liked <span class="co"># we created a new column which has the same name with original one. (liked column)</span></a></code></pre></div>
<p>Now, it is time to build classification model. The most successful classification models for NLP are Decision Tree,Random Forest and Naive Bayes.</p>
<p>I will continuewith Random Forest</p>
<p>-Random Forest Classification-</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="co"># Encoding the target feature as factor</span></a>
<a class="sourceLine" id="cb25-2" title="2">dataset<span class="op">$</span>Liked =<span class="st"> </span><span class="kw">factor</span>(dataset<span class="op">$</span>Liked, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</a></code></pre></div>
<p>We also do not need feature scaling. We have already zeros and ones.</p>
<p>Splitting the dataset into the Training set and Test set</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="co"># install.packages('caTools')</span></a>
<a class="sourceLine" id="cb26-2" title="2"><span class="kw">library</span>(caTools)</a>
<a class="sourceLine" id="cb26-3" title="3"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb26-4" title="4">split =<span class="st"> </span><span class="kw">sample.split</span>(dataset<span class="op">$</span>Liked, <span class="dt">SplitRatio =</span> <span class="fl">0.8</span>)</a>
<a class="sourceLine" id="cb26-5" title="5">training_set =<span class="st"> </span><span class="kw">subset</span>(dataset, split <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb26-6" title="6">test_set =<span class="st"> </span><span class="kw">subset</span>(dataset, split <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)</a></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="co"># Fitting Random Forest Classification to the Training set</span></a>
<a class="sourceLine" id="cb27-2" title="2"><span class="co"># install.packages('randomForest')</span></a>
<a class="sourceLine" id="cb27-3" title="3"><span class="kw">library</span>(randomForest)</a></code></pre></div>
<pre><code>## randomForest 4.6-14

## Type rfNews() to see new features/changes/bug fixes.
</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1">classifier =<span class="st"> </span><span class="kw">randomForest</span>(<span class="dt">x =</span> training_set[<span class="op">-</span><span class="dv">692</span>], <span class="co"># training set shouldn't include  dependent variable</span></a>
<a class="sourceLine" id="cb29-2" title="2">                          <span class="dt">y =</span> training_set<span class="op">$</span>Liked,</a>
<a class="sourceLine" id="cb29-3" title="3">                          <span class="dt">ntree =</span> <span class="dv">10</span>) </a>
<a class="sourceLine" id="cb29-4" title="4"><span class="co"># I'll try with 10 trees. But you can try with more trees and compare the accuracy of them to figure out most accurate result.</span></a></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="co"># Predicting the Test set results</span></a>
<a class="sourceLine" id="cb30-2" title="2">y_pred =<span class="st"> </span><span class="kw">predict</span>(classifier, <span class="dt">newdata =</span> test_set[<span class="op">-</span><span class="dv">692</span>])</a>
<a class="sourceLine" id="cb30-3" title="3">y_pred</a></code></pre></div>
<pre><code>##   4   9  10  16  17  21  24  33  39  40  41  48  56  58  59  61  63  73 
##   1   1   1   0   0   0   0   0   1   0   0   1   1   0   1   0   1   0 
##  76  82  92  93  98  99 105 112 113 115 116 122 123 142 150 152 154 157 
##   0   0   1   0   0   1   0   0   1   1   0   0   1   1   0   1   0   1 
## 158 159 161 169 182 183 184 188 190 191 193 199 202 203 210 211 217 222 
##   1   1   0   0   0   0   0   0   1   1   0   1   1   0   0   0   1   0 
## 228 239 240 250 251 255 258 262 264 270 272 276 287 292 303 306 314 318 
##   1   0   1   0   1   1   0   0   1   0   0   0   0   0   0   0   0   0 
## 326 328 337 344 345 346 349 351 353 361 363 364 370 375 395 396 397 399 
##   0   1   0   0   0   1   0   0   0   0   0   1   0   1   1   0   0   1 
## 412 413 415 416 430 433 445 446 453 456 466 469 470 473 486 495 496 509 
##   1   0   0   0   1   1   1   1   1   0   1   1   1   1   1   0   0   0 
## 519 521 525 528 531 535 539 545 548 555 560 563 568 570 574 583 586 591 
##   0   1   1   1   1   0   0   0   0   1   0   1   1   0   1   0   1   1 
## 598 606 613 614 618 625 628 633 634 639 641 647 648 653 658 668 674 679 
##   1   1   0   0   0   1   1   0   1   0   1   0   1   1   1   1   1   1 
## 688 694 698 712 715 716 719 730 739 743 752 759 761 768 780 789 795 807 
##   1   1   0   0   1   1   0   1   1   0   1   1   1   1   1   1   0   0 
## 809 811 817 818 821 844 848 849 853 855 863 868 874 882 890 891 892 894 
##   1   1   0   1   0   0   1   0   1   1   0   0   1   0   1   1   1   0 
## 900 905 906 912 915 920 924 931 935 938 939 941 953 956 965 973 977 983 
##   1   0   1   0   0   1   0   1   0   0   1   0   1   0   0   0   0   0 
## 985 996 
##   0   0 
## Levels: 0 1
</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="co"># Making the Confusion Matrix</span></a>
<a class="sourceLine" id="cb32-2" title="2">cm =<span class="st"> </span><span class="kw">table</span>(test_set[, <span class="dv">692</span>], y_pred)</a>
<a class="sourceLine" id="cb32-3" title="3">accuracy =<span class="st"> </span>(<span class="dv">82</span><span class="op">+</span><span class="dv">77</span>) <span class="op">/</span><span class="st"> </span>(<span class="dv">82</span><span class="op">+</span><span class="dv">77</span><span class="op">+</span><span class="dv">23</span><span class="op">+</span><span class="dv">18</span>)</a>
<a class="sourceLine" id="cb32-4" title="4">accuracy </a></code></pre></div>
<pre><code>## [1] 0.795
</code></pre>
<p>The accuracy of the model is 0.795</p>



</body></html>